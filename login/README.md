セキュリティ対策

・セッションハイジャック

対策方法
対策方法としては、Cookie の見える化を無くすことが必要。
具体的には、HTTPS 通信時の Cookie に secure 属性を付与したり、
セッション ID を URL に含めなくしたり、初期設定の「PHPSESSID」のセッション名を変更することが大切。

また、推測困難なセッション ID を生成するようにしたり、設定したセッション ID は受け付けない、アクセス毎にセッション ID を変更したりする方法が有効。

session_regenerate_id(true);

セッションの固定攻撃を防ぐのが、セッション ID をアクセス毎に変更できる session_regenerate_id 関数

・クリックジャッキング

対策方法
クリックジャッキングのセキュリティ対策方法はフレームでのページの読み込みを禁止するコードを設定することで回避が可能となる。
基本的に X-FRAME-OPTIONS ヘッダーを記述する必要がある。

Header set X-FRAME-OPTIONS “DENY”

アパッチの.htaccess に上記を記述をすれば、スクリプト毎に設定するという手間が省ける。

DENY はフレームでのページの読み込みの一切を禁止しているが、「SAMEORIGIN」や「ALLOW-FROM」という限定的にページの読み込みを許可するワードもある 7．

・SQL インジェクション

対策方法
この攻撃を防ぐためには、ユーザーからの入力を直接 SQL クエリに埋め込まないようにする必要がある。これを実現するために、「プレースホルダー｛？｝」を使用する。

プレースホルダーを使用することで、ユーザーの入力が直接 SQL クエリに埋め込まれることを防ぎ、SQL インジェクション攻撃を防止することができる。

mysql = "INSERT INTO your_table_name (name, email) VALUES (?, ?)"

・クロスサイトリクエストフォージェリ（CSRF）

対策方法
クロスサイトリクエストフォージェリへのセキュリティ対策方法はワンタイムトークンが効果的です。
ワンタイムトークンとはランダムな文字列のこと。

投稿フォームのページの表示前にトークンを生成し、セッションで保存されたトークンと送信フォームで埋め込んだトークンが
一致するかどうかで、リクエストが不正かどうかを確かめることができる。

// ランダムな文字列を生成してセッションに設定
csrf_token = ランダムな文字列;
\_SESSION[‘csrf_token’] = $csrf_token;
